{% comment %}
Compliance Status Widget - Embeddable Status Display

Lightweight compliance status widget for embedding in any page.
Provides real-time compliance monitoring with HTMX auto-refresh.
{% endcomment %}

{% load cotton %}

<div class="compliance-status-widget" 
     data-widget-size="{{ widget_size }}"
     hx-get="{% url 'compliance:status_widget' %}{% if object %}?object_id={{ object.id }}&content_type={{ object|model_name }}{% endif %}&widget_size={{ widget_size }}"
     hx-trigger="every 30s"
     hx-swap="outerHTML">
    
    {% if widget_size == 'small' %}
        <div class="inline-flex items-center">
            {% cotton 'compliance_status' status=status size='xs' %}
        </div>
    {% elif widget_size == 'large' %}
        <div class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
            <div class="flex items-center justify-between mb-2">
                <h4 class="text-sm font-medium text-gray-900">
                    {% if object %}{{ object|title }} Compliance{% else %}System Compliance{% endif %}
                </h4>
                {% cotton 'compliance_status' status=status %}
            </div>
            
            {% if total_checks %}
            <div class="text-xs text-gray-500">
                {{ total_checks }} checks performed
                {% if failed_checks > 0 %} - {{ failed_checks }} issues{% endif %}
            </div>
            {% endif %}
            
            <div class="text-xs text-gray-400 mt-1">
                Updated {{ timestamp|timesince }} ago
            </div>
        </div>
    {% else %}
        {# Medium size (default) #}
        <div class="flex items-center space-x-2">
            {% cotton 'compliance_status' status=status %}
            {% if total_checks %}
                <span class="text-xs text-gray-500">
                    {{ total_checks }} checks
                </span>
            {% endif %}
        </div>
    {% endif %}
</div>